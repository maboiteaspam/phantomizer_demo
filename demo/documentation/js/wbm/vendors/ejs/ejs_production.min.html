<!DOCTYPE html>

<html>
<head>
  <title>ejs_production.min.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="public/stylesheets/normalize.css" />
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div class="container">
    <div class="page">

      <div class="header">
        
          <h1>ejs_production.min.js</h1>
        

        
          <div class="toc">
            <h3>Table of Contents</h3>
            <ol>
              
                
                <li>
                  <a class="source" href="ejs.html">
                    ejs.js
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="ejs_production.min.html">
                    ejs_production.min.js
                  </a>
                </li>
              
                
                <li>
                  <a class="source" href="view.html">
                    view.js
                  </a>
                </li>
              
            </ol>
          </div>
        
      </div>

      
        
        
        
          <div class='highlight'><pre>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span><span class="hljs-keyword">var</span> rsplit=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(string,regex)</span>{</span><span class="hljs-keyword">var</span> result=regex.exec(string),retArr=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(),first_idx,last_idx,first_bit;<span class="hljs-keyword">while</span>(result!=<span class="hljs-literal">null</span>){first_idx=result.index;last_idx=regex.lastIndex;<span class="hljs-keyword">if</span>((first_idx)!=<span class="hljs-number">0</span>){first_bit=string.substring(<span class="hljs-number">0</span>,first_idx);retArr.push(string.substring(<span class="hljs-number">0</span>,first_idx));string=string.slice(first_idx)}retArr.push(result[<span class="hljs-number">0</span>]);string=string.slice(result[<span class="hljs-number">0</span>].length);result=regex.exec(string)}<span class="hljs-keyword">if</span>(!string==<span class="hljs-string">""</span>){retArr.push(string)}<span class="hljs-keyword">return</span> retArr},chop=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(string)</span>{</span><span class="hljs-keyword">return</span> string.substr(<span class="hljs-number">0</span>,string.length-<span class="hljs-number">1</span>)},extend=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(d,s)</span>{</span><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> n <span class="hljs-keyword">in</span> s){<span class="hljs-keyword">if</span>(s.hasOwnProperty(n)){d[n]=s[n]}}};EJS=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span>{</span>options=<span class="hljs-keyword">typeof</span> options==<span class="hljs-string">"string"</span>?{view:options}:options;<span class="hljs-keyword">this</span>.set_options(options);<span class="hljs-keyword">if</span>(options.precompiled){<span class="hljs-keyword">this</span>.template={};<span class="hljs-keyword">this</span>.template.process=options.precompiled;EJS.update(<span class="hljs-keyword">this</span>.name,<span class="hljs-keyword">this</span>);<span class="hljs-keyword">return</span> }<span class="hljs-keyword">if</span>(options.element){<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> options.element==<span class="hljs-string">"string"</span>){<span class="hljs-keyword">var</span> name=options.element;options.element=document.getElementById(options.element);<span class="hljs-keyword">if</span>(options.element==<span class="hljs-literal">null</span>){<span class="hljs-keyword">throw</span> name+<span class="hljs-string">"does not exist!"</span>}}<span class="hljs-keyword">if</span>(options.element.value){<span class="hljs-keyword">this</span>.text=options.element.value}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">this</span>.text=options.element.innerHTML}<span class="hljs-keyword">this</span>.name=options.element.id;<span class="hljs-keyword">this</span>.type=<span class="hljs-string">"["</span>}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">if</span>(options.url){options.url=EJS.endExt(options.url,<span class="hljs-keyword">this</span>.extMatch);<span class="hljs-keyword">this</span>.name=<span class="hljs-keyword">this</span>.name?<span class="hljs-keyword">this</span>.name:options.url;<span class="hljs-keyword">var</span> url=options.url;<span class="hljs-keyword">var</span> template=EJS.get(<span class="hljs-keyword">this</span>.name,<span class="hljs-keyword">this</span>.cache);<span class="hljs-keyword">if</span>(template){<span class="hljs-keyword">return</span> template}<span class="hljs-keyword">if</span>(template==EJS.INVALID_PATH){<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>}<span class="hljs-keyword">try</span>{<span class="hljs-keyword">this</span>.text=EJS.request(url+(<span class="hljs-keyword">this</span>.cache?<span class="hljs-string">""</span>:<span class="hljs-string">"?"</span>+<span class="hljs-built_in">Math</span>.random()))}<span class="hljs-keyword">catch</span>(e){}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.text==<span class="hljs-literal">null</span>){<span class="hljs-keyword">throw</span> ({type:<span class="hljs-string">"EJS"</span>,message:<span class="hljs-string">"There is no template at "</span>+url})}}}<span class="hljs-keyword">var</span> template=<span class="hljs-keyword">new</span> EJS.Compiler(<span class="hljs-keyword">this</span>.text,<span class="hljs-keyword">this</span>.type);template.compile(options,<span class="hljs-keyword">this</span>.name);EJS.update(<span class="hljs-keyword">this</span>.name,<span class="hljs-keyword">this</span>);<span class="hljs-keyword">this</span>.template=template};EJS.prototype={render:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(object,extra_helpers)</span>{</span>object=object||{};<span class="hljs-keyword">this</span>._extra_helpers=extra_helpers;<span class="hljs-keyword">var</span> v=<span class="hljs-keyword">new</span> EJS.Helpers(object,extra_helpers||{});<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.template.process.call(object,object,v)},update:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(element,options)</span>{</span><span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> element==<span class="hljs-string">"string"</span>){element=document.getElementById(element)}<span class="hljs-keyword">if</span>(options==<span class="hljs-literal">null</span>){_template=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(object)</span>{</span>EJS.prototype.update.call(_template,element,object)}}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> options==<span class="hljs-string">"string"</span>){params={};params.url=options;_template=<span class="hljs-keyword">this</span>;params.onComplete=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(request)</span>{</span><span class="hljs-keyword">var</span> object=<span class="hljs-built_in">eval</span>(request.responseText);EJS.prototype.update.call(_template,element,object)};EJS.ajax_request(params)}<span class="hljs-keyword">else</span>{element.innerHTML=<span class="hljs-keyword">this</span>.render(options)}},out:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.template.out},set_options:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span>{</span><span class="hljs-keyword">this</span>.type=options.type||EJS.type;<span class="hljs-keyword">this</span>.cache=options.cache!=<span class="hljs-literal">null</span>?options.cache:EJS.cache;<span class="hljs-keyword">this</span>.text=options.text||<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.name=options.name||<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.ext=options.ext||EJS.ext;<span class="hljs-keyword">this</span>.extMatch=<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-keyword">this</span>.ext.replace(<span class="hljs-regexp">/\./</span>,<span class="hljs-string">"."</span>))}};EJS.endExt=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(path,match)</span>{</span><span class="hljs-keyword">if</span>(!path){<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>}match.lastIndex=<span class="hljs-number">0</span>;<span class="hljs-keyword">return</span> path+(match.test(path)?<span class="hljs-string">""</span>:<span class="hljs-keyword">this</span>.ext)};EJS.Scanner=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(source,left,right)</span>{</span>extend(<span class="hljs-keyword">this</span>,{left_delimiter:left+<span class="hljs-string">"%"</span>,right_delimiter:<span class="hljs-string">"%"</span>+right,double_left:left+<span class="hljs-string">"%%"</span>,double_right:<span class="hljs-string">"%%"</span>+right,left_equal:left+<span class="hljs-string">"%="</span>,left_comment:left+<span class="hljs-string">"%#"</span>});<span class="hljs-keyword">this</span>.SplitRegexp=left==<span class="hljs-string">"["</span>?<span class="hljs-regexp">/(\[%%)|(%%\])|(\[%=)|(\[%#)|(\[%)|(%\]\n)|(%\])|(\n)/</span>:<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"("</span>+<span class="hljs-keyword">this</span>.double_left+<span class="hljs-string">")|(%%"</span>+<span class="hljs-keyword">this</span>.double_right+<span class="hljs-string">")|("</span>+<span class="hljs-keyword">this</span>.left_equal+<span class="hljs-string">")|("</span>+<span class="hljs-keyword">this</span>.left_comment+<span class="hljs-string">")|("</span>+<span class="hljs-keyword">this</span>.left_delimiter+<span class="hljs-string">")|("</span>+<span class="hljs-keyword">this</span>.right_delimiter+<span class="hljs-string">"\n)|("</span>+<span class="hljs-keyword">this</span>.right_delimiter+<span class="hljs-string">")|(\n)"</span>);<span class="hljs-keyword">this</span>.source=source;<span class="hljs-keyword">this</span>.stag=<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.lines=<span class="hljs-number">0</span>};EJS.Scanner.to_text=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(input)</span>{</span><span class="hljs-keyword">if</span>(input==<span class="hljs-literal">null</span>||input===<span class="hljs-literal">undefined</span>){<span class="hljs-keyword">return</span><span class="hljs-string">""</span>}<span class="hljs-keyword">if</span>(input <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span>){<span class="hljs-keyword">return</span> input.toDateString()}<span class="hljs-keyword">if</span>(input.toString){<span class="hljs-keyword">return</span> input.toString()}<span class="hljs-keyword">return</span><span class="hljs-string">""</span>};EJS.Scanner.prototype={scan:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(block)</span>{</span>scanline=<span class="hljs-keyword">this</span>.scanline;regex=<span class="hljs-keyword">this</span>.SplitRegexp;<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.source==<span class="hljs-string">""</span>){<span class="hljs-keyword">var</span> source_split=rsplit(<span class="hljs-keyword">this</span>.source,<span class="hljs-regexp">/\n/</span>);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;source_split.length;i++){<span class="hljs-keyword">var</span> item=source_split[i];<span class="hljs-keyword">this</span>.scanline(item,regex,block)}}},scanline:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(line,regex,block)</span>{</span><span class="hljs-keyword">this</span>.lines++;<span class="hljs-keyword">var</span> line_split=rsplit(line,regex);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;line_split.length;i++){<span class="hljs-keyword">var</span> token=line_split[i];<span class="hljs-keyword">if</span>(token!=<span class="hljs-literal">null</span>){<span class="hljs-keyword">try</span>{block(token,<span class="hljs-keyword">this</span>)}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">throw</span> {type:<span class="hljs-string">"EJS.Scanner"</span>,line:<span class="hljs-keyword">this</span>.lines}}}}}};EJS.Buffer=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(pre_cmd,post_cmd)</span>{</span><span class="hljs-keyword">this</span>.line=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();<span class="hljs-keyword">this</span>.script=<span class="hljs-string">""</span>;<span class="hljs-keyword">this</span>.pre_cmd=pre_cmd;<span class="hljs-keyword">this</span>.post_cmd=post_cmd;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-keyword">this</span>.pre_cmd.length;i++){<span class="hljs-keyword">this</span>.push(pre_cmd[i])}};EJS.Buffer.prototype={push:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(cmd)</span>{</span><span class="hljs-keyword">this</span>.line.push(cmd)},cr:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span><span class="hljs-keyword">this</span>.script=<span class="hljs-keyword">this</span>.script+<span class="hljs-keyword">this</span>.line.join(<span class="hljs-string">"; "</span>);<span class="hljs-keyword">this</span>.line=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();<span class="hljs-keyword">this</span>.script=<span class="hljs-keyword">this</span>.script+<span class="hljs-string">"\n"</span>},close:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span><span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.line.length&gt;<span class="hljs-number">0</span>){<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-keyword">this</span>.post_cmd.length;i++){<span class="hljs-keyword">this</span>.push(pre_cmd[i])}<span class="hljs-keyword">this</span>.script=<span class="hljs-keyword">this</span>.script+<span class="hljs-keyword">this</span>.line.join(<span class="hljs-string">"; "</span>);line=<span class="hljs-literal">null</span>}}};EJS.Compiler=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(source,left)</span>{</span><span class="hljs-keyword">this</span>.pre_cmd=[<span class="hljs-string">"var ___ViewO = [];"</span>];<span class="hljs-keyword">this</span>.post_cmd=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();<span class="hljs-keyword">this</span>.source=<span class="hljs-string">" "</span>;<span class="hljs-keyword">if</span>(source!=<span class="hljs-literal">null</span>){<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> source==<span class="hljs-string">"string"</span>){source=source.replace(<span class="hljs-regexp">/\r\n/g</span>,<span class="hljs-string">"\n"</span>);source=source.replace(<span class="hljs-regexp">/\r/g</span>,<span class="hljs-string">"\n"</span>);<span class="hljs-keyword">this</span>.source=source}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">if</span>(source.innerHTML){<span class="hljs-keyword">this</span>.source=source.innerHTML}}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.source!=<span class="hljs-string">"string"</span>){<span class="hljs-keyword">this</span>.source=<span class="hljs-string">""</span>}}left=left||<span class="hljs-string">"&lt;"</span>;<span class="hljs-keyword">var</span> right=<span class="hljs-string">"&gt;"</span>;<span class="hljs-keyword">switch</span>(left){<span class="hljs-keyword">case</span><span class="hljs-string">"["</span>:right=<span class="hljs-string">"]"</span>;<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span><span class="hljs-string">"&lt;"</span>:<span class="hljs-keyword">break</span>;<span class="hljs-keyword">default</span>:<span class="hljs-keyword">throw</span> left+<span class="hljs-string">" is not a supported deliminator"</span>;<span class="hljs-keyword">break</span>}<span class="hljs-keyword">this</span>.scanner=<span class="hljs-keyword">new</span> EJS.Scanner(<span class="hljs-keyword">this</span>.source,left,right);<span class="hljs-keyword">this</span>.out=<span class="hljs-string">""</span>};EJS.Compiler.prototype={compile:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options,name)</span>{</span>options=options||{};<span class="hljs-keyword">this</span>.out=<span class="hljs-string">""</span>;<span class="hljs-keyword">var</span> put_cmd=<span class="hljs-string">"___ViewO.push("</span>;<span class="hljs-keyword">var</span> insert_cmd=put_cmd;<span class="hljs-keyword">var</span> buff=<span class="hljs-keyword">new</span> EJS.Buffer(<span class="hljs-keyword">this</span>.pre_cmd,<span class="hljs-keyword">this</span>.post_cmd);<span class="hljs-keyword">var</span> content=<span class="hljs-string">""</span>;<span class="hljs-keyword">var</span> clean=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(content)</span>{</span>content=content.replace(<span class="hljs-regexp">/\\/g</span>,<span class="hljs-string">"\\\\"</span>);content=content.replace(<span class="hljs-regexp">/\n/g</span>,<span class="hljs-string">"\\n"</span>);content=content.replace(<span class="hljs-regexp">/"/g</span>,<span class="hljs-string">'\\"'</span>);<span class="hljs-keyword">return</span> content};<span class="hljs-keyword">this</span>.scanner.scan(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(token,scanner)</span>{</span><span class="hljs-keyword">if</span>(scanner.stag==<span class="hljs-literal">null</span>){<span class="hljs-keyword">switch</span>(token){<span class="hljs-keyword">case</span><span class="hljs-string">"\n"</span>:content=content+<span class="hljs-string">"\n"</span>;buff.push(put_cmd+<span class="hljs-string">'"'</span>+clean(content)+<span class="hljs-string">'");'</span>);buff.cr();content=<span class="hljs-string">""</span>;<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> scanner.left_delimiter:<span class="hljs-keyword">case</span> scanner.left_equal:<span class="hljs-keyword">case</span> scanner.left_comment:scanner.stag=token;<span class="hljs-keyword">if</span>(content.length&gt;<span class="hljs-number">0</span>){buff.push(put_cmd+<span class="hljs-string">'"'</span>+clean(content)+<span class="hljs-string">'")'</span>)}content=<span class="hljs-string">""</span>;<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> scanner.double_left:content=content+scanner.left_delimiter;<span class="hljs-keyword">break</span>;<span class="hljs-keyword">default</span>:content=content+token;<span class="hljs-keyword">break</span>}}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">switch</span>(token){<span class="hljs-keyword">case</span> scanner.right_delimiter:<span class="hljs-keyword">switch</span>(scanner.stag){<span class="hljs-keyword">case</span> scanner.left_delimiter:<span class="hljs-keyword">if</span>(content[content.length-<span class="hljs-number">1</span>]==<span class="hljs-string">"\n"</span>){content=chop(content);buff.push(content);buff.cr()}<span class="hljs-keyword">else</span>{buff.push(content)}<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> scanner.left_equal:buff.push(insert_cmd+<span class="hljs-string">"(EJS.Scanner.to_text("</span>+content+<span class="hljs-string">")))"</span>);<span class="hljs-keyword">break</span>}scanner.stag=<span class="hljs-literal">null</span>;content=<span class="hljs-string">""</span>;<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> scanner.double_right:content=content+scanner.right_delimiter;<span class="hljs-keyword">break</span>;<span class="hljs-keyword">default</span>:content=content+token;<span class="hljs-keyword">break</span>}}});<span class="hljs-keyword">if</span>(content.length&gt;<span class="hljs-number">0</span>){buff.push(put_cmd+<span class="hljs-string">'"'</span>+clean(content)+<span class="hljs-string">'")'</span>)}buff.close();<span class="hljs-keyword">this</span>.out=buff.script+<span class="hljs-string">";"</span>;<span class="hljs-keyword">var</span> to_be_evaled=<span class="hljs-string">"/*"</span>+name+<span class="hljs-string">"*/this.process = function(_CONTEXT,_VIEW) { try { with(_VIEW) { with (_CONTEXT) {"</span>+<span class="hljs-keyword">this</span>.out+<span class="hljs-string">" return ___ViewO.join('');}}}catch(e){e.lineNumber=null;throw e;}};"</span>;<span class="hljs-keyword">try</span>{<span class="hljs-built_in">eval</span>(to_be_evaled)}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> JSLINT!=<span class="hljs-string">"undefined"</span>){JSLINT(<span class="hljs-keyword">this</span>.out);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;JSLINT.errors.length;i++){<span class="hljs-keyword">var</span> error=JSLINT.errors[i];<span class="hljs-keyword">if</span>(error.reason!=<span class="hljs-string">"Unnecessary semicolon."</span>){error.line++;<span class="hljs-keyword">var</span> e=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>();e.lineNumber=error.line;e.message=error.reason;<span class="hljs-keyword">if</span>(options.view){e.fileName=options.view}<span class="hljs-keyword">throw</span> e}}}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">throw</span> e}}}};EJS.config=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span>{</span>EJS.cache=options.cache!=<span class="hljs-literal">null</span>?options.cache:EJS.cache;EJS.type=options.type!=<span class="hljs-literal">null</span>?options.type:EJS.type;EJS.ext=options.ext!=<span class="hljs-literal">null</span>?options.ext:EJS.ext;<span class="hljs-keyword">var</span> templates_directory=EJS.templates_directory||{};EJS.templates_directory=templates_directory;EJS.get=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(path,cache)</span>{</span><span class="hljs-keyword">if</span>(cache==<span class="hljs-literal">false</span>){<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>}<span class="hljs-keyword">if</span>(templates_directory[path]){<span class="hljs-keyword">return</span> templates_directory[path]}<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>};EJS.update=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(path,template)</span>{</span><span class="hljs-keyword">if</span>(path==<span class="hljs-literal">null</span>){<span class="hljs-keyword">return</span> }templates_directory[path]=template};EJS.INVALID_PATH=-<span class="hljs-number">1</span>};EJS.config({cache:<span class="hljs-literal">true</span>,type:<span class="hljs-string">"&lt;"</span>,ext:<span class="hljs-string">".ejs"</span>});EJS.Helpers=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data,extras)</span>{</span><span class="hljs-keyword">this</span>._data=data;<span class="hljs-keyword">this</span>._extras=extras;extend(<span class="hljs-keyword">this</span>,extras)};EJS.Helpers.prototype={view:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options,data,helpers)</span>{</span><span class="hljs-keyword">if</span>(!helpers){helpers=<span class="hljs-keyword">this</span>._extras}<span class="hljs-keyword">if</span>(!data){data=<span class="hljs-keyword">this</span>._data}<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> EJS(options).render(data,helpers)},to_text:<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(input,null_text)</span>{</span><span class="hljs-keyword">if</span>(input==<span class="hljs-literal">null</span>||input===<span class="hljs-literal">undefined</span>){<span class="hljs-keyword">return</span> null_text||<span class="hljs-string">""</span>}<span class="hljs-keyword">if</span>(input <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span>){<span class="hljs-keyword">return</span> input.toDateString()}<span class="hljs-keyword">if</span>(input.toString){<span class="hljs-keyword">return</span> input.toString().replace(<span class="hljs-regexp">/\n/g</span>,<span class="hljs-string">"&lt;br /&gt;"</span>).replace(<span class="hljs-regexp">/''/g</span>,<span class="hljs-string">"'"</span>)}<span class="hljs-keyword">return</span><span class="hljs-string">""</span>}};EJS.newRequest=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span><span class="hljs-keyword">var</span> factories=[<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">"Msxml2.XMLHTTP"</span>)},<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> XMLHttpRequest()},<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">"Microsoft.XMLHTTP"</span>)}];<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;factories.length;i++){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">var</span> request=factories[i]();<span class="hljs-keyword">if</span>(request!=<span class="hljs-literal">null</span>){<span class="hljs-keyword">return</span> request}}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">continue</span>}}};EJS.request=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(path)</span>{</span><span class="hljs-keyword">var</span> request=<span class="hljs-keyword">new</span> EJS.newRequest();request.open(<span class="hljs-string">"GET"</span>,path,<span class="hljs-literal">false</span>);<span class="hljs-keyword">try</span>{request.send(<span class="hljs-literal">null</span>)}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>}<span class="hljs-keyword">if</span>(request.status==<span class="hljs-number">404</span>||request.status==<span class="hljs-number">2</span>||(request.status==<span class="hljs-number">0</span>&amp;&amp;request.responseText==<span class="hljs-string">""</span>)){<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>}<span class="hljs-keyword">return</span> request.responseText};EJS.ajax_request=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(params)</span>{</span>params.method=(params.method?params.method:<span class="hljs-string">"GET"</span>);<span class="hljs-keyword">var</span> request=<span class="hljs-keyword">new</span> EJS.newRequest();request.onreadystatechange=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span><span class="hljs-keyword">if</span>(request.readyState==<span class="hljs-number">4</span>){<span class="hljs-keyword">if</span>(request.status==<span class="hljs-number">200</span>){params.onComplete(request)}<span class="hljs-keyword">else</span>{params.onComplete(request)}}};request.open(params.method,params.url);request.send(<span class="hljs-literal">null</span>)}})();EJS.Helpers.prototype.date_tag=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(C,O,A)</span>{</span><span class="hljs-keyword">if</span>(!(O <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span>)){O=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()}<span class="hljs-keyword">var</span> B=[<span class="hljs-string">"January"</span>,<span class="hljs-string">"February"</span>,<span class="hljs-string">"March"</span>,<span class="hljs-string">"April"</span>,<span class="hljs-string">"May"</span>,<span class="hljs-string">"June"</span>,<span class="hljs-string">"July"</span>,<span class="hljs-string">"August"</span>,<span class="hljs-string">"September"</span>,<span class="hljs-string">"October"</span>,<span class="hljs-string">"November"</span>,<span class="hljs-string">"December"</span>];<span class="hljs-keyword">var</span> G=[],D=[],P=[];<span class="hljs-keyword">var</span> J=O.getFullYear();<span class="hljs-keyword">var</span> H=O.getMonth();<span class="hljs-keyword">var</span> N=O.getDate();<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> M=J-<span class="hljs-number">15</span>;M&lt;J+<span class="hljs-number">15</span>;M++){G.push({value:M,text:M})}<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> E=<span class="hljs-number">0</span>;E&lt;<span class="hljs-number">12</span>;E++){D.push({value:(E),text:B[E]})}<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> I=<span class="hljs-number">0</span>;I&lt;<span class="hljs-number">31</span>;I++){P.push({value:(I+<span class="hljs-number">1</span>),text:(I+<span class="hljs-number">1</span>)})}<span class="hljs-keyword">var</span> L=<span class="hljs-keyword">this</span>.select_tag(C+<span class="hljs-string">"[year]"</span>,J,G,{id:C+<span class="hljs-string">"[year]"</span>});<span class="hljs-keyword">var</span> F=<span class="hljs-keyword">this</span>.select_tag(C+<span class="hljs-string">"[month]"</span>,H,D,{id:C+<span class="hljs-string">"[month]"</span>});<span class="hljs-keyword">var</span> K=<span class="hljs-keyword">this</span>.select_tag(C+<span class="hljs-string">"[day]"</span>,N,P,{id:C+<span class="hljs-string">"[day]"</span>});<span class="hljs-keyword">return</span> L+F+K};EJS.Helpers.prototype.form_tag=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(B,A)</span>{</span>A=A||{};A.action=B;<span class="hljs-keyword">if</span>(A.multipart==<span class="hljs-literal">true</span>){A.method=<span class="hljs-string">"post"</span>;A.enctype=<span class="hljs-string">"multipart/form-data"</span>}<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.start_tag_for(<span class="hljs-string">"form"</span>,A)};EJS.Helpers.prototype.form_tag_end=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tag_end(<span class="hljs-string">"form"</span>)};EJS.Helpers.prototype.hidden_field_tag=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(A,C,B)</span>{</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.input_field_tag(A,C,<span class="hljs-string">"hidden"</span>,B)};EJS.Helpers.prototype.input_field_tag=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(A,D,C,B)</span>{</span>B=B||{};B.id=B.id||A;B.value=D||<span class="hljs-string">""</span>;B.type=C||<span class="hljs-string">"text"</span>;B.name=A;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.single_tag_for(<span class="hljs-string">"input"</span>,B)};EJS.Helpers.prototype.is_current_page=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(A)</span>{</span><span class="hljs-keyword">return</span>(window.location.href==A||window.location.pathname==A?<span class="hljs-literal">true</span>:<span class="hljs-literal">false</span>)};EJS.Helpers.prototype.link_to=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(B,A,C)</span>{</span><span class="hljs-keyword">if</span>(!B){<span class="hljs-keyword">var</span> B=<span class="hljs-string">"null"</span>}<span class="hljs-keyword">if</span>(!C){<span class="hljs-keyword">var</span> C={}}<span class="hljs-keyword">if</span>(C.confirm){C.onclick=<span class="hljs-string">' var ret_confirm = confirm("'</span>+C.confirm+<span class="hljs-string">'"); if(!ret_confirm){ return false;} '</span>;C.confirm=<span class="hljs-literal">null</span>}C.href=A;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.start_tag_for(<span class="hljs-string">"a"</span>,C)+B+<span class="hljs-keyword">this</span>.tag_end(<span class="hljs-string">"a"</span>)};EJS.Helpers.prototype.submit_link_to=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(B,A,C)</span>{</span><span class="hljs-keyword">if</span>(!B){<span class="hljs-keyword">var</span> B=<span class="hljs-string">"null"</span>}<span class="hljs-keyword">if</span>(!C){<span class="hljs-keyword">var</span> C={}}C.onclick=C.onclick||<span class="hljs-string">""</span>;<span class="hljs-keyword">if</span>(C.confirm){C.onclick=<span class="hljs-string">' var ret_confirm = confirm("'</span>+C.confirm+<span class="hljs-string">'"); if(!ret_confirm){ return false;} '</span>;C.confirm=<span class="hljs-literal">null</span>}C.value=B;C.type=<span class="hljs-string">"submit"</span>;C.onclick=C.onclick+(A?<span class="hljs-keyword">this</span>.url_for(A):<span class="hljs-string">""</span>)+<span class="hljs-string">"return false;"</span>;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.start_tag_for(<span class="hljs-string">"input"</span>,C)};EJS.Helpers.prototype.link_to_if=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(F,B,A,D,C,E)</span>{</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.link_to_unless((F==<span class="hljs-literal">false</span>),B,A,D,C,E)};EJS.Helpers.prototype.link_to_unless=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(E,B,A,C,D)</span>{</span>C=C||{};<span class="hljs-keyword">if</span>(E){<span class="hljs-keyword">if</span>(D&amp;&amp;<span class="hljs-keyword">typeof</span> D==<span class="hljs-string">"function"</span>){<span class="hljs-keyword">return</span> D(B,A,C,D)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">return</span> B}}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.link_to(B,A,C)}};EJS.Helpers.prototype.link_to_unless_current=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(B,A,C,D)</span>{</span>C=C||{};<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.link_to_unless(<span class="hljs-keyword">this</span>.is_current_page(A),B,A,C,D)};EJS.Helpers.prototype.password_field_tag=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(A,C,B)</span>{</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.input_field_tag(A,C,<span class="hljs-string">"password"</span>,B)};EJS.Helpers.prototype.select_tag=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(D,G,H,F)</span>{</span>F=F||{};F.id=F.id||D;F.value=G;F.name=D;<span class="hljs-keyword">var</span> B=<span class="hljs-string">""</span>;B+=<span class="hljs-keyword">this</span>.start_tag_for(<span class="hljs-string">"select"</span>,F);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> E=<span class="hljs-number">0</span>;E&lt;H.length;E++){<span class="hljs-keyword">var</span> C=H[E];<span class="hljs-keyword">var</span> A={value:C.value};<span class="hljs-keyword">if</span>(C.value==G){A.selected=<span class="hljs-string">"selected"</span>}B+=<span class="hljs-keyword">this</span>.start_tag_for(<span class="hljs-string">"option"</span>,A)+C.text+<span class="hljs-keyword">this</span>.tag_end(<span class="hljs-string">"option"</span>)}B+=<span class="hljs-keyword">this</span>.tag_end(<span class="hljs-string">"select"</span>);<span class="hljs-keyword">return</span> B};EJS.Helpers.prototype.single_tag_for=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(A,B)</span>{</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tag(A,B,<span class="hljs-string">"/&gt;"</span>)};EJS.Helpers.prototype.start_tag_for=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(A,B)</span>{</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tag(A,B)};EJS.Helpers.prototype.submit_tag=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(A,B)</span>{</span>B=B||{};B.type=B.type||<span class="hljs-string">"submit"</span>;B.value=A||<span class="hljs-string">"Submit"</span>;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.single_tag_for(<span class="hljs-string">"input"</span>,B)};EJS.Helpers.prototype.tag=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(C,E,D)</span>{</span><span class="hljs-keyword">if</span>(!D){<span class="hljs-keyword">var</span> D=<span class="hljs-string">"&gt;"</span>}<span class="hljs-keyword">var</span> B=<span class="hljs-string">" "</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> A <span class="hljs-keyword">in</span> E){<span class="hljs-keyword">if</span>(E[A]!=<span class="hljs-literal">null</span>){<span class="hljs-keyword">var</span> F=E[A].toString()}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">var</span> F=<span class="hljs-string">""</span>}<span class="hljs-keyword">if</span>(A==<span class="hljs-string">"Class"</span>){A=<span class="hljs-string">"class"</span>}<span class="hljs-keyword">if</span>(F.indexOf(<span class="hljs-string">"'"</span>)!=-<span class="hljs-number">1</span>){B+=A+<span class="hljs-string">'="'</span>+F+<span class="hljs-string">'" '</span>}<span class="hljs-keyword">else</span>{B+=A+<span class="hljs-string">"='"</span>+F+<span class="hljs-string">"' "</span>}}<span class="hljs-keyword">return</span><span class="hljs-string">"&lt;"</span>+C+B+D};EJS.Helpers.prototype.tag_end=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(A)</span>{</span><span class="hljs-keyword">return</span><span class="hljs-string">"&lt;/"</span>+A+<span class="hljs-string">"&gt;"</span>};EJS.Helpers.prototype.text_area_tag=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(A,C,B)</span>{</span>B=B||{};B.id=B.id||A;B.name=B.name||A;C=C||<span class="hljs-string">""</span>;<span class="hljs-keyword">if</span>(B.size){B.cols=B.size.split(<span class="hljs-string">"x"</span>)[<span class="hljs-number">0</span>];B.rows=B.size.split(<span class="hljs-string">"x"</span>)[<span class="hljs-number">1</span>];<span class="hljs-keyword">delete</span> B.size}B.cols=B.cols||<span class="hljs-number">50</span>;B.rows=B.rows||<span class="hljs-number">4</span>;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.start_tag_for(<span class="hljs-string">"textarea"</span>,B)+C+<span class="hljs-keyword">this</span>.tag_end(<span class="hljs-string">"textarea"</span>)};EJS.Helpers.prototype.text_tag=EJS.Helpers.prototype.text_area_tag;EJS.Helpers.prototype.text_field_tag=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(A,C,B)</span>{</span><span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.input_field_tag(A,C,<span class="hljs-string">"text"</span>,B)};EJS.Helpers.prototype.url_for=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(A)</span>{</span><span class="hljs-keyword">return</span><span class="hljs-string">'window.location="'</span>+A+<span class="hljs-string">'";'</span>};EJS.Helpers.prototype.img_tag=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(B,C,A)</span>{</span>A=A||{};A.src=B;A.alt=C;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.single_tag_for(<span class="hljs-string">"img"</span>,A)}</pre></div>
        
      
      <div class="fleur">h</div>
    </div>
  </div>
</body>
</html>
